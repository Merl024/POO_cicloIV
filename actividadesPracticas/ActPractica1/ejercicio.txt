import java.util.Scanner;

public class TextProcessor {
    
    /* OPERACION 1 */
    /*  contabilizar cuantas palabras tiene el texto.
            - No tome en cuenta las mayúsculas. 
            - No contabilice signos de puntuación. */
    public static int conteoPalabras(String texto) {
        // Ignoramos mayusculas
        texto = texto.toLowerCase();

        // Reemplazar a los signos de puntuacion y numeros para evitar que aparezcan en el conteo
        texto = texto.replaceAll("[.,;:!?/¿¡\"'()\\[\\]{}0-9]", " ");
        
        // Identificamos las palabras. 
        String[] palabras = texto.trim().split("\\s+");

        // Imprimos con conteo las palabras para comprobar 
        System.out.println("Palabras detectadas:");
        int contador = 0;
        for (String palabra : palabras) {
            contador+=1;
            System.out.println(contador + ". " + palabra);
        }
        // Contamos las palabras
        return contador;
    }

    /* OPERACION 2 */
    /*  Palabra mas frecuente y cuantas veces se repite.
        No tome en cuenta si está en mayúscula o minúscula. Tampoco cuente los signos de puntación. */
    public static String palabraFrecuente(String texto){
        
        // Convertimos el párrafo a minúsculas y eliminamos puntuaciones básicas
        texto = texto.toLowerCase().replaceAll("[.,;:!?/¿¡\"'()\\[\\]{}0-9]", "");
        
        // Dividir el párrafo en palabras
        String[] palabras = texto.trim().split(" ");
        int n = palabras.length;
        
        // Array para marcar palabras ya contadas
        boolean[] contadas = new boolean[n];

        System.out.println("\nPalabras repetidas en el párrafo:");
        String palabraMasRepetida = "";
        int maxRpeticiones = 0;

        for (int i = 0; i < n; i++) {
            if (contadas[i]) continue; // Si ya se contó, saltar

            int contador = 1; // Contamos la palabra actual

            for (int j = i + 1; j < n; j++) {
                if (palabras[i].equals(palabras[j])) {
                    contador++;
                    contadas[j] = true; // Marcar palabra como contada
                }
            }

            if (contador > maxRpeticiones){
                maxRpeticiones = contador;
                palabraMasRepetida = palabras[i];
            }
            if(maxRpeticiones < 0){
                return "No hay palabras repetidas";
            }
            
        }
        return "La palabra mas frecuente es '" + palabraMasRepetida + "' apareciendo " + maxRpeticiones + " repeticiones.";
    }
    
    /* OPERACION 3 */
    /* Encontrar todas las palabras palíndromas en el texto.
        - Listar las PALABRAS palíndromas encontradas y su posición en el texto. */
    public static boolean esPalindromo(String texto) {
        // Convertir a minúsculas
        texto = texto.toLowerCase();
        texto = texto.replaceAll("[^a-z]", "");
        // texto = texto.toLowerCase().replaceAll("[.,;:!?/¿¡\"'()\\[\\]{}0-9]", " ");
        // System.out.println("Texto limpio; " + texto);

        // Verificar si es palíndromo
        int izquierda = 0;
        int derecha = texto.length() - 1;

        while (izquierda < derecha) {
            if (texto.charAt(izquierda) != texto.charAt(derecha)) {
                return false;
            }
            izquierda++;
            derecha--;
        }
        return true;
    }

    /* FUNCION MAIN */
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        // System.out.println("Ingrese su parrafo: ");
        // String parrafo = scanner.nextLine();

        /* ?????? No contamos las palabras que tengan acentuacion?????  */
        String parrafo = """
                Ejercicio 2: Procesador de Texto Avanzado (50 puntos) 
                Desarrolla un programa que procese un texto y realice 
                varios análisis utilizando bucles y estructuras de control. 
                El programa debe demostrar comprensión de bucles while/for  
                y manejo de strings. Ana lava la tina y reconoce el nivel de radar.
                """;
        System.out.println(parrafo);
        boolean condicion = true;
    
        while (condicion) {
            System.out.println("\tEscoja una de las siguientes opciones: ");
            System.out.println("""                
                1. Contar las palabras en el texto.
                2. Encontrar la palabra mas frecuente y cuántas veces aparece.
                3. Encontrar todas las palabras palíndromas en el texto.
                4. Generar estadísticas de vocales y consonantes.
                5. Invertir cada palabra de 4 letras o más que aparece en el texto
                6. Salir.\n
                """);
            int opcion = scanner.nextInt();
            switch (opcion){
                case 1 -> {
                    System.out.println("La cadena tiene " + conteoPalabras(parrafo) + " palabras\n");
                    break;
                }
                case 2 -> {
                    System.out.println(palabraFrecuente(parrafo));
                    break;
                }
                case 3 -> {
                    String[] palabras = parrafo.trim().split("\\s+"); // Dividir el texto en palabras
                    System.out.println("Palabras palíndromas encontradas: ");
                    boolean palindromasEncontradas = false;
                    for (int i = 0; i < palabras.length; i++) {
                        if (!palabras[i].isEmpty() && esPalindromo(palabras[i])) {
                            System.out.println("Palabra: " + palabras[i] + ". Posición: " + (i + 1));
                            palindromasEncontradas = true;
                        }
                    }

                    if (!palindromasEncontradas) {
                        System.out.println("No hay palabras palíndromas.");
                    }
                    break;
                }
                case 4 -> {
                    break;
                }
                case 5 -> {
                    break;
                }
                case 6 -> {
                    condicion = false;
                    System.out.println("Saliendo del programa...");
                    break;
                }
                default -> System.out.println("Opción incorrecta. Intente nuevamente.");
            }
        }
    }
}

